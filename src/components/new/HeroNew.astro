---
import { useTranslations } from '../../i18n/utils';

export interface Props {
	lang?: string;
}

const { lang = 'en' } = Astro.props;
const t = useTranslations(lang as 'en' | 'es');
---

<!-- Hero Section with Parallax Landscape -->
<div class="hero-wrapper" id="hero-section">
	<div class="parallax-container">
		<!-- Landscape Group -->
		<div class="landscape-group">
			<div class="parallax-layer layer-blob" data-speed="0.1">
				<img
					src="/images/new/home/Vector Blob.svg"
					alt="Vector Blob"
					class="parallax-image"
					loading="eager"
				/>
			</div>
			<div class="parallax-layer layer-clouds" data-speed="0.2">
				<img
					src="/images/new/home/landscape/Clouds.svg"
					alt="Clouds"
					class="parallax-image"
					loading="eager"
				/>
			</div>
			<div class="parallax-layer layer-mountains" data-speed="0.3">
				<img
					src="/images/new/home/landscape/mountains.svg"
					alt="Mountains"
					class="parallax-image"
					loading="eager"
				/>
			</div>
			<div class="parallax-layer layer-forest" data-speed="0.7">
				<img
					src="/images/new/home/landscape/forest-left.svg"
					alt="Forest"
					class="parallax-image"
					loading="eager"
				/>
			</div>
			<div class="parallax-layer layer-forest-right" data-speed="0.7">
				<img
					src="/images/new/home/landscape/forest-right.svg"
					alt="Forest Right"
					class="parallax-image"
					loading="eager"
				/>
			</div>
			<div class="parallax-layer layer-bird" data-speed="0.9">
				<img
					src="/images/new/home/landscape/Bird.svg"
					alt="Bird"
					class="parallax-image"
					loading="eager"
				/>
			</div>
		</div>
	</div>

	<!-- Content Overlay -->
	<div class="content-container">
		<div class="hero-content">
			<h1 class="hero-title">Elevate your<br />operations<br />software</h1>
		</div>
	</div>
</div>

<script>
	function initParallax() {
		const heroSection = document.getElementById('hero-section');
		if (!heroSection) return;

		const parallaxLayers = heroSection.querySelectorAll('.parallax-layer');
		let ticking = false;

		function updateParallax() {
			if (!heroSection) return;

			const scrolled = window.pageYOffset;
			const heroHeight = heroSection.offsetHeight;
			const scrollPercent = Math.min(scrolled / heroHeight, 1);

			parallaxLayers.forEach((layer) => {
				const speed = parseFloat(layer.getAttribute('data-speed') || '0.5');
				const yPos = -(scrolled * speed);
				const isForest = layer.classList.contains('layer-forest');
				const isForestRight = layer.classList.contains('layer-forest-right');
				const isMountains = layer.classList.contains('layer-mountains');
				const isClouds = layer.classList.contains('layer-clouds');
				const isBlob = layer.classList.contains('layer-blob');
				const isBird = layer.classList.contains('layer-bird');

				if (isMountains) {
					// Centralizar horizontalmente e aplicar parallax vertical
					(layer as HTMLElement).style.transform = `translate(calc(-50% + 0px), ${yPos}px)`;
				} else if (isClouds) {
					// Centralizar horizontalmente e aplicar parallax vertical
					(layer as HTMLElement).style.transform = `translate(calc(-50% + 0px), ${yPos}px)`;
				} else if (isBlob) {
					// Aplicar rotação e parallax vertical
					(layer as HTMLElement).style.transform = `rotate(1.867deg) translateY(${yPos}px)`;
				} else if (isForest || isForestRight) {
					(layer as HTMLElement).style.transform = `translateY(${yPos}px)`;
				} else if (isBird) {
					(layer as HTMLElement).style.transform = `rotate(1.21deg) translateY(${yPos}px)`;
				} else {
					(layer as HTMLElement).style.transform = `translateY(${yPos}px)`;
				}
			});

			ticking = false;
		}

		function requestTick() {
			if (!ticking) {
				window.requestAnimationFrame(updateParallax);
				ticking = true;
			}
		}

		window.addEventListener('scroll', requestTick, { passive: true });
		// Initial call to set transforms
		parallaxLayers.forEach((layer) => {
			const isForest = layer.classList.contains('layer-forest');
			const isForestRight = layer.classList.contains('layer-forest-right');
			const isMountains = layer.classList.contains('layer-mountains');
			const isClouds = layer.classList.contains('layer-clouds');
			const isBlob = layer.classList.contains('layer-blob');
			const isBird = layer.classList.contains('layer-bird');

			if (isMountains) {
				// Centralizar horizontalmente
				(layer as HTMLElement).style.transform = `translate(calc(-50% + 0px), 0px)`;
			} else if (isClouds) {
				// Centralizar horizontalmente
				(layer as HTMLElement).style.transform = `translate(calc(-50% + 0px), 0px)`;
			} else if (isBlob) {
				// Aplicar rotação inicial
				(layer as HTMLElement).style.transform = `rotate(1.867deg) translateY(0px)`;
			} else if (isForest || isForestRight) {
				(layer as HTMLElement).style.transform = `translateY(0px)`;
			} else if (isBird) {
				(layer as HTMLElement).style.transform = `rotate(1.21deg) translateY(0px)`;
			} else {
				(layer as HTMLElement).style.transform = `translateY(0px)`;
			}
		});
		updateParallax(); // Initial call
	}

	// Initialize on DOM ready
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', initParallax);
	} else {
		initParallax();
	}
</script>

<style>
	.hero-wrapper {
		position: relative;
		width: 100vw;
		height: 100vh;
		min-height: 100vh;
		overflow: hidden;
		display: flex;
		align-items: center;
		justify-content: center;
		border-radius: 0;
		background: 
			/* Pattern SVG overlay - círculos com espaçamento cx/cy = 2, r = 2, opacidade ~90% */
			url("data:image/svg+xml,%3Csvg width='4' height='4' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='2' cy='2' r='2' fill='%23000' opacity='0.1'/%3E%3C/svg%3E"),
			/* Gradiente Radial Secundário com opacidade 20% */
				radial-gradient(
					252.76deg 116.83% at 50% 50%,
					rgba(255, 255, 255, 0) 0%,
					rgba(46, 58, 51, 0.2) 40%
				),
			/* Gradiente Radial Primário */
				radial-gradient(256.09deg 112.84% at 96.63% 6.02%, #faefe0 0%, #ccbba3 100%);
		background-size:
			4px 4px,
			100% 100%,
			100% 100%;
		background-position:
			0 0,
			center,
			center;
		background-repeat: repeat, no-repeat, no-repeat;
		background-attachment: fixed, fixed, fixed;
		background-blend-mode: normal;
	}

	.parallax-container {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: 0;
	}

	.landscape-group {
		position: relative;
		width: 100%;
		height: 100%;
		box-sizing: border-box;
	}

	.parallax-layer {
		position: absolute;
		will-change: transform;
		flex-shrink: 0;
		box-sizing: border-box;
	}

	.parallax-image {
		width: 100%;
		height: 100%;
		object-fit: contain;
		object-position: center;
		display: block;
	}

	.layer-blob {
		z-index: -1;
		width: 1463.516px;
		height: 1312.615px;
		right: -150px;
		top: -230px;
		flex-shrink: 0;
		transform: rotate(1.867deg);
		box-sizing: border-box;
	}

	.layer-clouds {
		z-index: 0;
		width: 2193.518px;
		height: 233.416px;
		left: 50%;
		top: 68px;
		flex-shrink: 0;
		transform: translateX(-50%);
		box-sizing: border-box;
	}

	.layer-mountains {
		z-index: 1;
		width: 3353.65px;
		height: 295.435px;
		left: 50%;
		top: 156px;
		flex-shrink: 0;
		transform: translateX(-50%);
		box-sizing: border-box;
	}

	.layer-forest {
		z-index: 3;
		width: 660px;
		height: 314px;
		top: 424px;
		left: -20px;
		flex-shrink: 0;
	}

	.layer-forest-right {
		z-index: 3;
		width: 661px;
		height: 341px;
		top: 396px;
		right: -40px;
		flex-shrink: 0;
	}

	.layer-bird {
		z-index: 4;
		width: 36px;
		height: 18px;
		left: 900px;
		top: 114px;
		flex-shrink: 0;
		transform: rotate(1.21deg);
	}

	.content-container {
		position: absolute;
		z-index: 10;
		width: 100%;
		max-width: 1200px;
		top: 434px;
		left: 50%;
		transform: translateX(-50%);
		padding: 0 20px;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.hero-content {
		text-align: center;
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 24px;
		max-width: 800px;
	}

	.hero-title {
		width: 804px;
		color: #54504b;
		text-align: center;
		text-shadow:
			0 -2px 4px rgba(0, 0, 0, 0.25),
			0 2px 4px rgba(255, 255, 255, 0.4);
		font-family: 'Young Serif', serif;
		font-size: 88px;
		font-style: normal;
		font-weight: 400;
		line-height: 96px;
		letter-spacing: 2.64px;
		margin: 0;
	}

	.hero-subtitle {
		font-family: 'Bitter', serif;
		font-size: 32px;
		font-weight: 400;
		line-height: 1.4;
		color: var(--grey-5);
		margin: 0;
		text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
	}

	.hero-cta-button {
		background-color: var(--mint);
		color: var(--grey-5);
		border: none;
		border-radius: 4px;
		padding: 12px 24px;
		font-family: 'Bitter', serif;
		font-size: 18px;
		font-weight: 700;
		text-decoration: none;
		box-shadow: 1px 1px 2px rgba(21, 26, 23, 0.5);
		transition: all 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);
		margin-top: 8px;
		display: inline-block;
	}

	.hero-cta-button:hover {
		background-color: var(--green-500);
		color: var(--grey-5);
		box-shadow: 2px 2px 5px rgba(21, 26, 23, 0.2);
		transform: translateY(-2px);
	}

	/* Responsive Design */
	@media (max-width: 1024px) {
		.hero-wrapper {
			min-height: 500px;
		}

		.layer-blob {
			width: 100%;
			height: auto;
			max-height: 1312.615px;
		}

		.layer-clouds {
			width: 100%;
			height: auto;
			max-height: 233.416px;
		}

		.layer-mountains {
			width: 100%;
			height: auto;
			max-height: 295.435px;
		}

		.layer-forest {
			width: 100%;
			height: auto;
			max-height: 314px;
		}

		.layer-forest-right {
			width: 100%;
			height: auto;
			max-height: 341px;
		}

		.hero-title {
			font-size: 48px;
		}

		.hero-subtitle {
			font-size: 28px;
		}
	}

	@media (max-width: 768px) {
		.hero-wrapper {
			height: 80vh;
			min-height: 500px;
		}

		.layer-blob {
			width: 100%;
			height: auto;
			max-height: 1000px;
		}

		.layer-clouds {
			width: 100%;
			height: auto;
			max-height: 200px;
		}

		.layer-mountains {
			width: 100%;
			height: auto;
			max-height: 250px;
		}

		.layer-forest {
			width: 100%;
			height: auto;
			max-height: 250px;
		}

		.layer-forest-right {
			width: 100%;
			height: auto;
			max-height: 250px;
		}

		.content-container {
			padding: 0 16px;
		}

		.hero-content {
			gap: 20px;
		}

		.hero-title {
			font-size: 36px;
			line-height: 1.3;
		}

		.hero-subtitle {
			font-size: 22px;
			line-height: 1.4;
		}

		.hero-cta-button {
			padding: 10px 20px;
			font-size: 16px;
		}
	}

	@media (max-width: 480px) {
		.hero-wrapper {
			height: 70vh;
			min-height: 400px;
		}

		.layer-blob {
			width: 100%;
			height: auto;
			max-height: 800px;
		}

		.layer-clouds {
			width: 100%;
			height: auto;
			max-height: 150px;
		}

		.layer-mountains {
			width: 100%;
			height: auto;
			max-height: 200px;
		}

		.layer-forest {
			width: 100%;
			height: auto;
			max-height: 200px;
		}

		.layer-forest-right {
			width: 100%;
			height: auto;
			max-height: 200px;
		}

		.hero-title {
			font-size: 28px;
		}

		.hero-subtitle {
			font-size: 18px;
		}

		.hero-cta-button {
			padding: 10px 18px;
			font-size: 14px;
			width: 100%;
			max-width: 240px;
		}
	}
</style>
