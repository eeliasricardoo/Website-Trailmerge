---
// Required by Astro i18n
// In dev/SSR: middleware handles redirect
// In static builds: generates minimal HTML that redirects instantly
if (import.meta.env.SSR) {
	const acceptLanguage = Astro.request.headers.get('accept-language') || '';
	const prefersSpanish = acceptLanguage.toLowerCase().includes('es');
	const redirectUrl = prefersSpanish ? '/es/' : '/en/';
	
	return new Response(null, {
		status: 307,
		headers: {
			'Location': redirectUrl,
			'Cache-Control': 'no-cache',
		},
	});
}
---
<!doctype html>
<script is:inline>
// Ultra-fast redirect - executes before any rendering
(function(){var l=(navigator.language||navigator.userLanguage||'en').toLowerCase();window.location.replace(l.startsWith('es')?'/es/':'/en/');})();
</script>
