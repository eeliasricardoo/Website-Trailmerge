---
export const prerender = false;

export async function getStaticPaths() {
	return [{ params: { lang: 'en' } }, { params: { lang: 'es' } }];
}

import { ViewTransitions } from 'astro:transitions';
import SEOHead from '../../components/SEOHead.astro';
import SEOSchema from '../../components/SEOSchema.astro';
import { useTranslations } from '../../i18n/utils';
import { getAlternateUrls } from '../../utils/routeMapping';
import '../../styles/global.css';

// Import new redesigned components
import NavbarNew from '../../components/new/NavbarNew.astro';
import HeroNew from '../../components/new/HeroNew.astro';
import AsideSectionNew from '../../components/new/AsideSectionNew.astro';
import CompaniesSectionNew from '../../components/new/CompaniesSectionNew.astro';
import OurApproachNew from '../../components/new/OurApproachNew.astro';
import RecentProjectsNew from '../../components/new/RecentProjectsNew.astro';
import FooterNew from '../../components/new/FooterNew.astro';

const { lang } = Astro.params || { lang: 'en' };

if (lang && typeof lang === 'string' && !['en', 'es'].includes(lang)) {
	return new Response(null, {
		status: 404,
		statusText: 'Not Found',
	});
}

const t = useTranslations(lang as 'en' | 'es');
const canonicalURL = new URL(Astro.url.pathname, Astro.site).href;
const alternateUrls = getAlternateUrls(Astro.url.pathname, Astro.site?.href || '');
const isStaging =
	Astro.site?.hostname === 'staging.trailmerge.com' ||
	Astro.url.hostname === 'staging.trailmerge.com';
const htmlLang = lang === 'es' ? 'es' : 'en-US';
---

<!doctype html>
<html lang={htmlLang}>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="icon" type="image/x-icon" href="/images/favicon.png" />
		<meta name="generator" content={Astro.generator} />

		<SEOHead
			title={t('homepage.seo.title')}
			description={t('homepage.seo.description')}
			canonicalURL={canonicalURL}
			lang={lang}
			alternateUrls={alternateUrls}
			isStaging={isStaging}
		/>

		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=Young+Serif&family=Bitter:ital,wght@0,400;0,500;0,700;1,400&family=Roboto:wght@400;500;700&display=swap"
			rel="stylesheet"
		/>

		<SEOSchema
			type="organization"
			pageTitle={t('homepage.seo.title')}
			pageDescription={t('homepage.seo.description')}
		/>

		<ViewTransitions />
	</head>
	<body>
		<NavbarNew lang={lang} />
		<main id="main-content">
			<HeroNew lang={lang} />
			<AsideSectionNew
				lang={lang}
				title="Take the design-first path to the top"
				text="Trailmerge equips enterprise operations and technology teams with strategic digital transformation consulting, user experience and product expertise, and custom software development, to conquer costly inefficiencies and level up your team's excellence."
			/>
			<CompaniesSectionNew lang={lang} />
			<OurApproachNew lang={lang} />
			<RecentProjectsNew lang={lang} />
			<FooterNew lang={lang} />
		</main>
	</body>
</html>

<style is:global>
	html {
		width: 100%;
		min-height: 100vh;
		background:
			radial-gradient(
				256.09% 112.04% at 96.63% 6.02%,
				rgba(255, 255, 255, 0) 0%,
				rgba(46, 58, 51, 0.08) 100%
			),
			url('/images/new/home/dot-pattern.svg'),
			radial-gradient(283.15% 146.1% at 13.24% 9.21%, #faefe0 0%, #ccbba3 100%);
		background-size:
			100% 100%,
			9.24px 9.24px,
			100% 100%;
		background-position:
			center,
			0 0,
			center;
		background-repeat: no-repeat, repeat, no-repeat;
		background-attachment: fixed, fixed, fixed;
	}

	body {
		width: 100vw;
		min-height: 100vh;
		overflow-x: hidden;
		position: relative;
		background:
			radial-gradient(
				256.09% 112.04% at 96.63% 6.02%,
				rgba(255, 255, 255, 0) 0%,
				rgba(46, 58, 51, 0.08) 100%
			),
			url('/images/new/home/dot-pattern.svg'),
			radial-gradient(283.15% 146.1% at 13.24% 9.21%, #faefe0 0%, #ccbba3 100%);
		background-size:
			100% 100%,
			9.24px 9.24px,
			100% 100%;
		background-position:
			center,
			0 0,
			center;
		background-repeat: no-repeat, repeat, no-repeat;
		background-attachment: fixed, fixed, fixed;
	}

	#main-content {
		width: 100%;
		min-height: 100vh;
		position: relative;
		overflow: hidden;
	}
</style>
