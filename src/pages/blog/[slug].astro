---
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/Navbar.astro';
import Footer from '../../components/Footer.astro';
import ContactModal from '../../components/ContactModal.astro';
import { getPostBySlug, getAllPosts } from '../../data/blogPosts';

export async function getStaticPaths() {
	const posts = getAllPosts();
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: { post },
	}));
}

const { post } = Astro.props;

if (!post) {
	return Astro.redirect('/blog');
}

// Prepare article data for JSON-LD schema
const articleUrl = new URL(`/blog/${post.slug}`, Astro.site).href;
const articleData = {
	title: post.title,
	description: post.excerpt,
	image: post.image,
	datePublished: new Date(post.date).toISOString(),
	author: {
		name: post.author.name,
		image: post.author.image
	},
	url: articleUrl
};

// Breadcrumbs for blog posts
const breadcrumbs = [
	{ name: "Home", url: "https://trailmerge.com/" },
	{ name: "Blog", url: "https://trailmerge.com/blog/" },
	{ name: post.title, url: articleUrl }
];

// Generate keywords from post title and category
const keywords = `${post.category}, ${post.title}, UX design, B2B SaaS, product design, Trailmerge`;
---

<Layout
	title={`${post.title} â€“ Trailmerge Blog`}
	description={post.excerpt}
	schemaType="article"
	articleData={articleData}
	breadcrumbs={breadcrumbs}
	keywords={keywords}
>
	<Navbar />

	<main id="main-content">
		<!-- Blog Post Detail Page -->
		<article class="blog-detail-page">
		<div class="blog-detail-content">
			<!-- Hero Image -->
			<div class="blog-detail-hero">
				<img src={post.image} alt={post.imageAlt} class="blog-detail-image" />
			</div>

			<!-- Post Content -->
			<div class="blog-detail-wrapper">
			<div class="blog-detail-header">
				<h1 class="blog-detail-title">{post.title}</h1>
				<div class="blog-post-meta">
					<span class="blog-post-date">{post.date}</span>
					<span class="blog-meta-divider"> | </span>
					<span class="blog-post-category">{post.category}</span>
				</div>
			</div>

			<div class="spacer-2xl"></div>

				<!-- Blog Content -->
				<div class="blog-detail-body" set:html={post.content} />

				{post.imageCredit && (
					<div class="spacer-xl"></div>
					<p class="blog-image-credit">{post.imageCredit}</p>
				)}

				<div class="spacer-2xl"></div>

				<!-- Author Bio -->
				<div class="blog-author-section">
					<div class="blog-author-divider"></div>
					<div class="spacer-xl"></div>
					<div class="blog-author-content">
						<img src={post.author.image} alt={post.author.name} class="blog-author-image" />
						<div class="blog-author-info">
							<h2 class="blog-author-name">{post.author.name}</h2>
							<div class="spacer-s"></div>
							<p class="blog-author-bio">{post.author.bio}</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		</article>
	</main>

	<Footer />

	<ContactModal />
</Layout>

<style is:global>
	article.blog-detail-page .blog-detail-body h2 {
		color: var(--grey-5) !important;
		font-size: 28px !important;
		font-weight: 600 !important;
		line-height: 1.3 !important;
		margin-top: 72px !important;
		margin-bottom: 16px !important;
		font-family: Bitter, serif !important;
		text-align: left !important;
	}

	article.blog-detail-page .blog-detail-body h2:first-child {
		margin-top: 0 !important;
	}

	@media (max-width: 768px) {
		article.blog-detail-page .blog-detail-body h2 {
			font-size: 24px !important;
			margin-top: 56px !important;
			margin-bottom: 12px !important;
		}
	}

	@media (max-width: 480px) {
		article.blog-detail-page .blog-detail-body h2 {
			font-size: 24px !important;
			margin-top: 48px !important;
			margin-bottom: 12px !important;
		}
	}
</style>

<style>
	.blog-detail-page {
		background-color: var(--off-white);
		padding-top: 120px;
		padding-bottom: 80px;
		min-height: 100vh;
		font-family: Roboto, sans-serif;
	}

	.blog-detail-content {
		max-width: 1000px;
		margin: 0 auto;
		padding: 0 20px;
	}

	.blog-detail-hero {
		width: 100%;
		margin-bottom: 0;
	}

	.blog-detail-image {
		width: 100%;
		height: 400px;
		display: block;
		object-fit: cover;
		border-radius: 0;
	}

	.blog-detail-wrapper {
		background-color: transparent;
		border-radius: 0;
		padding: 16px 64px 56px 64px;
		margin-top: 0;
		position: relative;
		z-index: 1;
	}

	.blog-detail-header {
		text-align: center;
	}

	.blog-detail-header h1.blog-detail-title {
		color: var(--grey-5);
		font-size: 32px !important;
		font-weight: 700 !important;
		line-height: 1.2 !important;
		margin: 0 0 16px !important;
		font-family: Literata, sans-serif !important;
	}

	.blog-post-meta {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 8px;
		font-size: 12px;
		font-weight: 600;
		letter-spacing: 0.5px;
		color: var(--grey-3);
		font-family: Roboto, sans-serif;
		margin-top: 16px;
	}

	.blog-post-date,
	.blog-post-category {
		color: var(--grey-3);
	}

	.blog-meta-divider {
		color: var(--grey-3);
	}

	.blog-detail-body {
		color: var(--grey-4);
		font-size: 16px;
		line-height: 1.8;
		font-family: Roboto, sans-serif;
		text-align: left;
	}


	.blog-detail-body p {
		margin-bottom: 32px;
		color: var(--grey-4);
		font-size: 16px;
		line-height: 1.8;
		font-family: Roboto, sans-serif;
		font-weight: 400;
	}

	.blog-detail-body p:last-child {
		margin-bottom: 0;
	}

	.blog-image-credit {
		color: var(--grey-3);
		font-size: 14px;
		font-style: italic;
		margin: 0;
		font-family: Roboto, sans-serif;
		line-height: 1.6;
	}

	.blog-author-section {
		margin-top: 56px;
		padding-top: 0;
	}

	.blog-author-divider {
		width: 100%;
		height: 1px;
		background-color: var(--grey-1);
	}

	.blog-author-content {
		display: flex;
		gap: 24px;
		align-items: flex-start;
		margin-top: 32px;
	}

	.blog-author-image {
		width: 120px;
		height: 120px;
		border-radius: 50%;
		object-fit: cover;
		flex-shrink: 0;
	}

	.blog-author-info {
		flex: 1;
	}

	.blog-author-name {
		color: var(--grey-5);
		font-size: 24px;
		font-weight: 700;
		line-height: 1.3;
		margin: 0 0 8px 0;
		font-family: Roboto, sans-serif;
	}

	.blog-author-bio {
		color: var(--grey-4);
		font-size: 16px;
		line-height: 1.8;
		margin: 0;
		font-family: Roboto, sans-serif;
	}

	/* Responsive Design */
	@media (max-width: 1024px) {
		.blog-detail-page {
			padding-top: 100px;
			padding-bottom: 60px;
		}

		.blog-detail-wrapper {
			padding: 12px 40px 48px 40px;
			margin-top: 0;
		}

		.blog-detail-header h1.blog-detail-title {
			font-size: 30px !important;
		}

		.blog-detail-image {
			height: 350px;
		}
	}

	@media (max-width: 768px) {
		.blog-detail-page {
			padding-top: 80px;
			padding-bottom: 48px;
		}

		.blog-detail-content {
			padding: 0 16px;
		}

		.blog-detail-wrapper {
			padding: 8px 32px 40px 32px;
			margin-top: 0;
		}

		.blog-detail-header h1.blog-detail-title {
			font-size: 28px !important;
			line-height: 1.25 !important;
		}

		.blog-detail-body {
			font-size: 16px;
		}

		.blog-detail-image {
			height: 300px;
		}


		.blog-detail-body p {
			font-size: 16px;
			margin-bottom: 24px;
		}

		.blog-author-content {
			flex-direction: column;
			align-items: center;
			text-align: center;
		}

		.blog-author-image {
			width: 100px;
			height: 100px;
		}
	}

	@media (max-width: 480px) {
		.blog-detail-page {
			padding-top: 72px;
			padding-bottom: 40px;
		}

		.blog-detail-content {
			padding: 0 16px;
		}

		.blog-detail-wrapper {
			padding: 8px 24px 32px 24px;
			margin-top: 0;
		}

		.blog-detail-header h1.blog-detail-title {
			font-size: 26px !important;
			line-height: 1.25 !important;
		}

		.blog-detail-image {
			height: 250px;
		}


		.blog-author-image {
			width: 80px;
			height: 80px;
		}

		.blog-author-name {
			font-size: 24px;
		}
	}
</style>

