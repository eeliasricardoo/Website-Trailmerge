---
import Layout from '../../../layouts/Layout.astro';
import Navbar from '../../../components/Navbar.astro';
import Footer from '../../../components/Footer.astro';
import ContactModal from '../../../components/ContactModal.astro';
import { getAllPosts } from '../../../data/blogPosts';
import { useTranslations } from '../../../i18n/utils';

export async function getStaticPaths() {
	const posts = getAllPosts();
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: { post },
	}));
}

const { post } = Astro.props;
const lang = 'en';
const t = useTranslations(lang);

if (!post) {
	return Astro.redirect('/en/blog');
}

// Prepare article data for JSON-LD schema
const articleUrl = new URL(`/en/blog/${post.slug}`, Astro.site).href;
const articleData = {
	title: post.title,
	description: post.excerpt,
	image: post.image,
	datePublished: new Date(post.date).toISOString(),
	author: {
		name: post.author.name,
		image: post.author.image
	},
	url: articleUrl
};

// Breadcrumbs for blog posts
const breadcrumbs = [
	{ name: t('blog.breadcrumbs.home'), url: "https://trailmerge.com/en/" },
	{ name: t('blog.breadcrumbs.blog'), url: "https://trailmerge.com/en/blog/" },
	{ name: post.title, url: articleUrl }
];

// Generate keywords from post title and category
const keywords = `${post.category}, ${post.title}, UX design, B2B SaaS, product design, Trailmerge`;
---

<Layout
	title={`${post.title} – ${t('blog.postTitleSuffix')}`}
	description={post.excerpt}
	schemaType="article"
	articleData={articleData}
	breadcrumbs={breadcrumbs}
	keywords={keywords}
	lang={lang}
>
	<Navbar lang={lang} />

	<main id="main-content">
		<!-- Blog Post Detail Page -->
		<article class="blog-detail-page">
		<div class="blog-detail-content">
			<!-- Hero Image -->
			<div class="blog-detail-hero">
				<img src={post.image} alt={post.imageAlt} class="blog-detail-image" />
			</div>

			<!-- Post Content -->
			<div class="blog-detail-wrapper">
			<div class="blog-detail-header">
				<h1 class="blog-detail-title">{post.title}</h1>
				<div class="blog-post-meta">
					<span class="blog-post-date">{post.date}</span>
					<span class="blog-meta-divider"> | </span>
					<span class="blog-post-category">{post.category}</span>
				</div>
			</div>

			<div class="spacer-2xl"></div>

				<!-- Blog Content -->
				<div class="blog-detail-body" set:html={post.content} />

				{post.imageCredit && (
					<div class="spacer-xl"></div>
					<p class="blog-image-credit">{post.imageCredit}</p>
				)}

				<div class="spacer-2xl"></div>

				<!-- Author Bio -->
				<div class="blog-author-section">
					<div class="blog-author-divider"></div>
					<div class="spacer-xl"></div>
					<div class="blog-author-content">
						<img src={post.author.image} alt={post.author.name} class="blog-author-image" />
						<div class="blog-author-info">
							<h2 class="blog-author-name">{post.author.name}</h2>
							<div class="spacer-s"></div>
							<p class="blog-author-bio">{post.author.bio}</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		</article>
	</main>

	<Footer lang={lang} />

	<ContactModal lang={lang} />
</Layout>

<style is:global>
	article.blog-detail-page .blog-detail-body h2 {
		color: var(--grey-5) !important;
		font-size: 28px !important;
		font-weight: 600 !important;
		line-height: 1.3 !important;
		margin-top: 48px !important;
		margin-bottom: 16px !important;
		font-family: Bitter, serif !important;
		text-align: left !important;
	}

	article.blog-detail-page .blog-detail-body h2:first-child {
		margin-top: 0 !important;
	}

	/* Estilização de imagens e GIFs dentro do conteúdo */
	article.blog-detail-page .blog-detail-body img {
		max-width: 100% !important;
		height: auto !important;
		border-radius: 8px !important;
		display: block !important;
		margin: 0 auto !important;
	}

	article.blog-detail-page .blog-detail-body div[style*="text-align: center"] {
		margin: 40px 0 !important;
		text-align: center !important;
	}

	article.blog-detail-page .blog-detail-body div[style*="text-align: center"] img {
		margin: 0 auto 12px auto !important;
		border-radius: 8px !important;
	}

	article.blog-detail-page .blog-detail-body div[style*="text-align: center"] p {
		color: var(--grey-3) !important;
		font-size: 14px !important;
		font-style: italic !important;
		line-height: 1.5 !important;
		margin: 8px 0 0 0 !important;
		text-align: center !important;
	}

	/* Estilização de listas */
	article.blog-detail-page .blog-detail-body ul {
		margin: 24px 0 32px 0 !important;
		padding-left: 24px !important;
		list-style-type: disc !important;
	}

	article.blog-detail-page .blog-detail-body li {
		color: var(--grey-4) !important;
		font-size: 16px !important;
		line-height: 1.8 !important;
		margin-bottom: 12px !important;
		font-family: Roboto, sans-serif !important;
	}

	article.blog-detail-page .blog-detail-body li:last-child {
		margin-bottom: 0 !important;
	}

	/* Estilização de strong (negrito) */
	article.blog-detail-page .blog-detail-body strong {
		font-weight: 700 !important;
		color: var(--grey-5) !important;
	}

	/* Estilização de em (itálico) */
	article.blog-detail-page .blog-detail-body em {
		font-style: italic !important;
	}

	/* Estilização de parágrafos */
	article.blog-detail-page .blog-detail-body p {
		margin-bottom: 24px !important;
		color: var(--grey-4) !important;
		font-size: 17px !important;
		line-height: 1.75 !important;
		font-family: Roboto, sans-serif !important;
		font-weight: 400 !important;
	}

	article.blog-detail-page .blog-detail-body p:last-child {
		margin-bottom: 0 !important;
	}

	@media (max-width: 768px) {
		article.blog-detail-page .blog-detail-body h2 {
			font-size: 24px !important;
			margin-top: 40px !important;
			margin-bottom: 12px !important;
		}

		article.blog-detail-page .blog-detail-body p {
			margin-bottom: 32px !important;
			font-size: 16px !important;
		}

		article.blog-detail-page .blog-detail-body div[style*="text-align: center"] {
			margin: 32px 0 !important;
		}

		article.blog-detail-page .blog-detail-body ul {
			padding-left: 20px !important;
		}
	}

	@media (max-width: 480px) {
		article.blog-detail-page .blog-detail-body h2 {
			font-size: 24px !important;
			margin-top: 32px !important;
			margin-bottom: 12px !important;
		}

		article.blog-detail-page .blog-detail-body p {
			margin-bottom: 28px !important;
			font-size: 15px !important;
		}

		article.blog-detail-page .blog-detail-body div[style*="text-align: center"] {
			margin: 24px 0 !important;
		}

		article.blog-detail-page .blog-detail-body div[style*="text-align: center"] p {
			font-size: 13px !important;
		}

		article.blog-detail-page .blog-detail-body ul {
			margin: 20px 0 24px 0 !important;
			padding-left: 20px !important;
		}

		article.blog-detail-page .blog-detail-body li {
			font-size: 15px !important;
			margin-bottom: 10px !important;
		}
	}
</style>

<style>
	.blog-detail-page {
		background-color: var(--off-white);
		padding-top: 120px;
		padding-bottom: 80px;
		min-height: 100vh;
		font-family: Roboto, sans-serif;
	}

	.blog-detail-content {
		max-width: 1000px;
		margin: 0 auto;
		padding: 0 20px;
	}

	.blog-detail-hero {
		width: 100%;
		margin-bottom: 0;
	}

	.blog-detail-image {
		width: 100%;
		height: 480px;
		display: block;
		object-fit: cover;
		border-radius: 0;
	}

	.blog-detail-wrapper {
		background-color: transparent;
		border-radius: 0;
		padding: 32px 64px 56px 64px;
		margin-top: 0;
		position: relative;
		z-index: 1;
		max-width: 900px;
		margin-left: auto;
		margin-right: auto;
	}

	.blog-detail-header {
		text-align: center;
	}

	.blog-detail-header h1.blog-detail-title {
		color: var(--grey-5);
		font-size: 32px !important;
		font-weight: 700 !important;
		line-height: 1.2 !important;
		margin: 0 0 16px !important;
		font-family: Literata, sans-serif !important;
	}

	.blog-post-meta {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 8px;
		font-size: 13px;
		font-weight: 600;
		letter-spacing: 0.5px;
		color: var(--grey-3);
		font-family: Roboto, sans-serif;
		margin-top: 12px;
		text-transform: uppercase;
	}

	.blog-post-date,
	.blog-post-category {
		color: var(--grey-3);
	}

	.blog-meta-divider {
		color: var(--grey-3);
	}

	.blog-detail-body {
		color: var(--grey-4);
		font-size: 17px;
		line-height: 1.75;
		font-family: Roboto, sans-serif;
		text-align: left;
	}

	.blog-detail-body p {
		margin-bottom: 40px;
		color: var(--grey-4);
		font-size: 17px;
		line-height: 1.75;
		font-family: Roboto, sans-serif;
		font-weight: 400;
	}

	.blog-detail-body p:last-child {
		margin-bottom: 0;
	}

	.blog-image-credit {
		color: var(--grey-3);
		font-size: 14px;
		font-style: italic;
		margin: 0;
		font-family: Roboto, sans-serif;
		line-height: 1.6;
	}

	.blog-author-section {
		margin-top: 64px;
		padding-top: 0;
	}

	.blog-author-divider {
		width: 100%;
		height: 1px;
		background-color: var(--grey-1);
	}

	.blog-author-content {
		display: flex;
		gap: 28px;
		align-items: flex-start;
		margin-top: 32px;
	}

	.blog-author-image {
		width: 150px;
		height: 150px;
		border-radius: 50%;
		object-fit: cover;
		flex-shrink: 0;
	}

	.blog-author-info {
		flex: 1;
	}

	.blog-author-name {
		color: var(--grey-5);
		font-size: 24px;
		font-weight: 700;
		line-height: 1.3;
		margin: 0 0 8px 0;
		font-family: Bitter, serif;
	}

	.blog-author-bio {
		color: var(--grey-4);
		font-size: 16px;
		line-height: 1.8;
		margin: 0;
		font-family: Roboto, sans-serif;
	}

	/* Responsive Design */
	@media (max-width: 1024px) {
		.blog-detail-page {
			padding-top: 100px;
			padding-bottom: 60px;
		}

		.blog-detail-wrapper {
			padding: 24px 48px 48px 48px;
			margin-top: 0;
		}

		.blog-detail-header h1.blog-detail-title {
			font-size: 30px !important;
		}

		.blog-detail-image {
			height: 420px;
		}
	}

	@media (max-width: 768px) {
		.blog-detail-page {
			padding-top: 80px;
			padding-bottom: 48px;
		}

		.blog-detail-content {
			padding: 0 20px;
		}

		.blog-detail-wrapper {
			padding: 24px 32px 40px 32px;
			margin-top: 0;
		}

		.blog-detail-header h1.blog-detail-title {
			font-size: 28px !important;
			line-height: 1.3 !important;
		}

		.blog-detail-body {
			font-size: 16px;
		}

		.blog-detail-image {
			height: 320px;
		}

		.blog-detail-body p {
			font-size: 16px;
			margin-bottom: 32px;
		}

		.blog-author-content {
			flex-direction: column;
			align-items: center;
			text-align: center;
			gap: 20px;
		}

		.blog-author-image {
			width: 130px;
			height: 130px;
		}
	}

	@media (max-width: 480px) {
		.blog-detail-page {
			padding-top: 72px;
			padding-bottom: 40px;
		}

		.blog-detail-content {
			padding: 0 16px;
		}

		.blog-detail-wrapper {
			padding: 20px 24px 32px 24px;
			margin-top: 0;
		}

		.blog-detail-header h1.blog-detail-title {
			font-size: 24px !important;
			line-height: 1.3 !important;
		}

		.blog-detail-image {
			height: 240px;
		}

		.blog-detail-body p {
			font-size: 15px;
			margin-bottom: 28px;
		}

		.blog-author-image {
			width: 100px;
			height: 100px;
		}

		.blog-author-name {
			font-size: 20px;
		}

		.blog-author-bio {
			font-size: 15px;
		}
	}
</style>

